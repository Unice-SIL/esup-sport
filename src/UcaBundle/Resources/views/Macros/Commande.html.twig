{% macro affiche(commande, source, form, refAvoir) %}
	{% if commande.commandeDetails %}
		{% if app.request.attributes.get('_route') == "UcaGest_AvoirDetails" %}
			{% set tabCmdDetails = commande.getCommmandeDetailsByAvoir(refAvoir) %}
		{% else %}
			{% set tabCmdDetails = commande.commandeDetails %}
		{% endif %}
		{% for article in tabCmdDetails %}
			<div class="row mb-4 px-2 py-3 container-style bg-white container-style-border-none d-flex flex-wrap justify-content-between align-items-center">
				<div class="col-12 col-sm-8">
					<p class="m-0 mb-1 p-0 col-12 text-uppercase fw-500 color-blue">{{article.item.articleLibelle}}</p>
					<p class="m-0 mb-1 p-0 col-12">{{article.item.articleDescription}}</p>
					{% if article.inscription is not null  %}
						{% for autorisation in article.inscription.autorisations %}
							{% set codeComportement = autorisation.typeAutorisation.comportement.codeComportement %}
							{% if codeComportement == 'carte' or codeComportement == 'cotisation' %}
								<p class="m-0 p-0 col-12 fs-14 color-taupe-gray">{{ autorisation.informationsComplementaires|nl2br }}</p>
							{% endif %}
						{% endfor %}
					{% endif %}
				</div>
				<div class="col-12 col-sm-4 d-flex align-items-center">
					<p class="w-50 p-0 py-3 m-0 text-left text-sm-right">
						{% if source == 'monpanier' and article.isRemovable %}
							<a class="d-flex align-items-center justify-content-start justify-content-sm-end fs-12 text-uppercase fw-500 color-taupe-gray" href='{{url('UcaWeb_SuppressionArticle', { id: article.id })}}' data-toggle='modal' data-target='#modalSuppression'>
								{{ 'bouton.supprimer' | trans }}
								<i class="fas fa-trash ml-2"></i>
							</a>
						{% endif %}
					</p>

					{% if article.montant == 0 %}
						<p class="w-50 m-0 p-0 py-3 text-right fw-500 color-blue">{{ 'Gratuit' | trans }}</p>
					{% else %}
						{% if (article.appartientAvoir() and app.request.attributes.get('_route') == "UcaGest_ReportingCommandeDetails") %}
							<p class="w-50 m-0 p-0 py-3 text-right fw-500 color-blue">
								<del> {{ article.montant ~ ' €' }} </del> &nbsp;
								<a class='btn btn-outline.disabled' tabindex="0" type="button" href="{{ path('UcaGest_AvoirDetails',{'id':article.commande.id, 'refAvoir':article.referenceAvoir}) }}" data-toggle="tooltip" data-placement="top" title="{{ 'commande.details.avoir.message' | trans }}">
									<span class='fa fa-info-circle' alt='' aria-label="{{ 'commande.details.avoir.message' | trans }}"></span>
								</a>
							</p>
						{% elseif app.request.attributes.get('_route') == "UcaGest_AvoirDetails" %}
							<p class="w-50 m-0 p-0 py-3 text-right fw-500 color-blue">
								{{ article.montant ~ ' €' }}
								&nbsp;
								<a class='btn btn-outline.disabled' tabindex="0" type="button" href="{{ path('UcaGest_ReportingCommandeDetails',{'id':article.commande.id}) }}" data-toggle="tooltip" data-placement="top" title="{{ 'detailscommande.list.title' | trans }}">
									<span class='fa fa-info-circle' alt='' aria-label="{{ 'detailscommande.list.title' | trans }}"></span>
								</a>
							</p>
						{% else %}
							<p class="w-50 m-0 p-0 py-3 text-right fw-500 color-blue">
								{{ article.montant ~ ' €' }}
							</p>

						{% endif %}
					{% endif %}
				</div>
			</div>
		{% endfor %}
		<div class="row mb-4 px-2 py-3 container-style bg-white container-style-border-none d-flex flex-wrap justify-content-between align-items-center">
			{% if commande.id %}
				<div class="col-6 d-flex align-items-center">
					<p class="p-0 m-0">
						{% if source == 'monpanier' %}
							<a class="d-flex align-items-center justify-content-end fs-12 text-uppercase fw-500 color-taupe-gray" href='{{url('UcaWeb_SuppressionToutArticle', { 'id': commande.id })}}' data-toggle='modal' data-target='#modalSuppression'>
								<i class="fas fa-trash mr-2"></i>
								Vider le panier
							</a>
						{% endif %}
					</p>
				</p>
			</div>
		{% endif %}

		
		{% if ((commande.statut == 'apayer' and source == 'mescommandes') or (commande.statut == 'panier' and source == 'monpanier') or (commande.statut == 'apayer' and source == 'gestioncaisse')) %}
			{% set credit = commande.utilisateur.getCreditTotal() %}
		{% else %}
			{% set credit = commande.creditUtilise %}
		{% endif %}
		<div class="col-6">
			<p class="p-0 m-0 text-uppercase fw-700 text-right">
				{{'common.total'|trans}}&nbsp;:&nbsp;&nbsp;
				<span class="color-blue ml-3">
					{% if not app.request.attributes.get('_route') == "UcaGest_AvoirDetails" %}
						{{ commande.montantTotal ~ '€' }}
					{% else %}
						{{ commande.getTotalAvoir(refAvoir) ~ '€' }}
					{% endif %}
				</span>
			</p>
			{% if app.request.attributes.get('_route') != "UcaGest_AvoirDetails" %}
				<p class="p-0 m-0 text-uppercase fw-700 text-right">
					{{'common.credit'|trans}}&nbsp;:&nbsp;
					<span class="color-blue ml-3">
						{{ (credit | number_format(2)) ~ '€' }}</span>
				</p>
				<p class="p-0 m-0 text-uppercase fw-700 text-right">
					{{ 'common.montant'|trans }}&nbsp;:&nbsp;
					<span class="color-blue ml-3">
						{% if credit > commande.montantTotal %}
							{{ (0 | number_format(2)) ~ '€' }}
						{% elseif credit <= commande.montantTotal %}
							{{ (commande.montantTotal - credit | number_format(2)) ~ '€' }}
						{% endif %}
					</span>
				</p>
			{% endif %}
		</div>
	</div>
	<div class="row mb-4 p-0">
		<div class="col-12 p-0 m-0 text-center text-md-right">
			{% if commande.statut == 'apayer' and source == 'mescommandes' or commande.statut == 'panier' and source == 'monpanier' %}
				{% if commande.montantTotal != 0  %}
					{% if form is not null and source != 'gestioncaisse' %}
						{{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}
						<div class="d-flex">
							<div class="ml-auto p-2">
								{{ form_widget(form.cgvAcceptees) }}
							</div>
						</div>
						{{ form_end(form) }}
					{% endif %}
					{% if source == 'monpanier' %}
						<a href="{{url('UcaWeb_PaiementRecapitulatif', { id: commande.id, typePaiement: 'BDS' })}}">{{ 'common.moyenpaiementautre' | trans }}</a>
					{% endif %}

				{% else %}
					<a class="btn btn-primary" href="{{url('UcaWeb_PaiementValidation', { id: commande.id, typePaiement: 'NA', source: source })}}">{{ 'paiement.gratuit.validation' | trans }}</a>
				{% endif %}
			{% endif %}

			{% if commande.statut == 'apayer' and source == 'gestioncaisse' %}
				<a id="boutonPaiementCarte" data-toggle="modal" data-target="#modalValidationPaiementcarte" class="btn btn-primary" href="{{url('UcaWeb_PaiementValidation', { id: commande.id, typePaiement:'BDS', source: source, moyenPaiement: 'cb' })}}">{{ 'paiement.cb.validation' | trans }}</a>
				<button id="boutonPaiementCheque" data-toggle="modal" data-target="#modalValidationPaiementcheque" class="btn btn-info">{{ 'paiement.cheque.validation' | trans }}</button>
				<a id="boutonPaiementEspece" data-toggle="modal" data-target="#modalValidationPaiementespece" class="btn btn-info" href="{{url('UcaWeb_PaiementValidation', { id: commande.id, typePaiement:'BDS', source: source, moyenPaiement: 'espece' })}}">{{ 'paiement.especes.validation' | trans }}</a><a id="boutonPaiementEspece" data-toggle="modal" data-target="#modalValidationPaiementespece" class="btn btn-info" href="{{url('UcaWeb_PaiementValidation', { id: commande.id, typePaiement:'BDS', source: source, moyenPaiement: 'espece' })}}">{{ 'paiement.especes.validation' | trans }}</a>
				{% include "@Uca/UcaWeb/Commande/Modal.PaiementValidation.html.twig" with { typePaiement : 'carte' } %}
				{% include "@Uca/UcaWeb/Commande/Modal.PaiementValidation.html.twig" with { typePaiement : 'cheque' } %}
				{% include "@Uca/UcaWeb/Commande/Modal.PaiementValidation.html.twig" with { typePaiement : 'espece' } %}
			{% endif %}
		</div>
	</div>
{% endif %}{% endmacro %}
